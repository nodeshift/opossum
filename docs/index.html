<!doctype html>
<html>
<head>
  <meta charset='utf-8'>
  <title>opossum 3.0.0 | Documentation</title>
  <meta name='description' content='A fail-fast circuit breaker for promises and callbacks'>
  <meta name='viewport' content='width=device-width,initial-scale=1'>
  <link href='assets/bass.css' rel='stylesheet'>
  <link href='assets/style.css' rel='stylesheet'>
  <link href='assets/github.css' rel='stylesheet'>
  <link href='assets/split.css' rel='stylesheet'>
</head>
<body class='documentation m0'>
    <div class='flex'>
      <div id='split-left' class='overflow-auto fs0 height-viewport-100'>
        <div class='py1 px2'>
          <h3 class='mb0 no-anchor'>opossum</h3>
          <div class='mb1'><code>3.0.0</code></div>
          <input
            placeholder='Filter'
            id='filter-input'
            class='col12 block input'
            type='text' />
          <div id='toc'>
            <ul class='list-reset h5 py1-ul'>
              
                
                <li><a
                  href='#readme'
                  class="h5 bold black caps">
                  README
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#circuitbreaker'
                  class=" toggle-sibling">
                  CircuitBreaker
                  <span class='icon'>â–¸</span>
                </a>
                
                <div class='toggle-target display-none'>
                  
                  <ul class='list-reset py1-ul pl1'>
                    <li class='h5'><span>Static members</span></li>
                    
                      <li><a
                        href='#circuitbreakercircuits'
                        class='regular pre-open'>
                        .circuits
                      </a></li>
                    
                    </ul>
                  
                  
                    <ul class='list-reset py1-ul pl1'>
                      <li class='h5'><span>Instance members</span></li>
                      
                      <li><a
                        href='#circuitbreakerclose'
                        class='regular pre-open'>
                        #close
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakeropen'
                        class='regular pre-open'>
                        #open
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakershutdown'
                        class='regular pre-open'>
                        #shutdown
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakerisshutdown'
                        class='regular pre-open'>
                        #isShutdown
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakername'
                        class='regular pre-open'>
                        #name
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakergroup'
                        class='regular pre-open'>
                        #group
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakerpendingclose'
                        class='regular pre-open'>
                        #pendingClose
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakerclosed'
                        class='regular pre-open'>
                        #closed
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakeropened'
                        class='regular pre-open'>
                        #opened
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakerhalfopen'
                        class='regular pre-open'>
                        #halfOpen
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakerstatus'
                        class='regular pre-open'>
                        #status
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakerstats'
                        class='regular pre-open'>
                        #stats
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakerenabled'
                        class='regular pre-open'>
                        #enabled
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakerwarmup'
                        class='regular pre-open'>
                        #warmUp
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakervolumethreshold'
                        class='regular pre-open'>
                        #volumeThreshold
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakerfallback'
                        class='regular pre-open'>
                        #fallback
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakerfire'
                        class='regular pre-open'>
                        #fire
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakerclearcache'
                        class='regular pre-open'>
                        #clearCache
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakerhealthcheck'
                        class='regular pre-open'>
                        #healthCheck
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakerenable'
                        class='regular pre-open'>
                        #enable
                      </a></li>
                      
                      <li><a
                        href='#circuitbreakerdisable'
                        class='regular pre-open'>
                        #disable
                      </a></li>
                      
                    </ul>
                  
                  
                  
                </div>
                
                </li>
              
                
                <li><a
                  href='#eventcircuitbreakerhalfopen'
                  class="">
                  CircuitBreaker#halfOpen
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#eventcircuitbreakerclose'
                  class="">
                  CircuitBreaker#close
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#eventcircuitbreakeropen'
                  class="">
                  CircuitBreaker#open
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#eventcircuitbreakershutdown'
                  class="">
                  CircuitBreaker#shutdown
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#eventcircuitbreakerfire'
                  class="">
                  CircuitBreaker#fire
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#eventcircuitbreakercachehit'
                  class="">
                  CircuitBreaker#cacheHit
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#eventcircuitbreakercachemiss'
                  class="">
                  CircuitBreaker#cacheMiss
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#eventcircuitbreakerreject'
                  class="">
                  CircuitBreaker#reject
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#eventcircuitbreakertimeout'
                  class="">
                  CircuitBreaker#timeout
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#eventcircuitbreakersuccess'
                  class="">
                  CircuitBreaker#success
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#eventcircuitbreakersemaphorelocked'
                  class="">
                  CircuitBreaker#semaphoreLocked
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#eventcircuitbreakerhealthcheckfailed'
                  class="">
                  CircuitBreaker#healthCheckFailed
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#eventcircuitbreakerfallback'
                  class="">
                  CircuitBreaker#fallback
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#eventcircuitbreakerfailure'
                  class="">
                  CircuitBreaker#failure
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#status'
                  class=" toggle-sibling">
                  Status
                  <span class='icon'>â–¸</span>
                </a>
                
                <div class='toggle-target display-none'>
                  
                  
                    <ul class='list-reset py1-ul pl1'>
                      <li class='h5'><span>Instance members</span></li>
                      
                      <li><a
                        href='#statusstats'
                        class='regular pre-open'>
                        #stats
                      </a></li>
                      
                      <li><a
                        href='#statuswindow'
                        class='regular pre-open'>
                        #window
                      </a></li>
                      
                    </ul>
                  
                  
                  
                </div>
                
                </li>
              
                
                <li><a
                  href='#eventstatussnapshot'
                  class="">
                  Status#snapshot
                  
                </a>
                
                </li>
              
            </ul>
          </div>
          <div class='mt1 h6 quiet'>
            <a href='https://documentation.js.org/reading-documentation.html'>Need help reading this?</a>
          </div>
        </div>
      </div>
      <div id='split-right' class='relative overflow-auto height-viewport-100'>
        
          
            <div class='keyline-top-not py2'><section class='py2 clearfix'>

  <h2 id='readme' class='mt0'>
    README
  </h2>

  
    <h1>opossum <a href="https://circleci.com/gh/nodeshift/opossum/tree/master"><img src="https://circleci.com/gh/nodeshift/opossum/tree/master.svg?style=svg&#x26;circle-token=0742302baa8c95cef354997ea52a383d3d078ff1" alt="CircleCI"></a></h1>
<p><a href="https://www.codacy.com/app/nodeshift/opossum?utm_source=github.com&#x26;utm_medium=referral&#x26;utm_content=nodeshift/opossum&#x26;utm_campaign=Badge_Grade"><img src="https://api.codacy.com/project/badge/Grade/03f9af1e697743edbe91f8d29831a75d" alt="Codacy Badge"></a>
<a href="https://www.codacy.com/app/nodeshift/opossum?utm_source=github.com&#x26;utm_medium=referral&#x26;utm_content=nodeshift/opossum&#x26;utm_campaign=Badge_Coverage"><img src="https://api.codacy.com/project/badge/Coverage/03f9af1e697743edbe91f8d29831a75d" alt="Codacy Badge"></a>
<a href="https://greenkeeper.io/"><img src="https://badges.greenkeeper.io/nodeshift/opossum.svg" alt="Greenkeeper badge"></a>
<a href="https://snyk.io/test/npm/opossum"><img src="https://snyk.io/test/npm/opossum/badge.svg" alt="Known Vulnerabilities"></a>
<a href="https://david-dm.org/nodeshift/opossum"><img src="https://david-dm.org/nodeshift/opossum/status.svg" alt="dependencies Status"></a></p>
<p><a href="https://npmjs.org/package/opossum"><img src="https://nodei.co/npm/opossum.png" alt="NPM"></a></p>
<p>Opossum is a Node.js circuit breaker that executes asynchronous functions
and monitors their execution status. When things start failing, <code>opossum</code>
plays dead and fails fast. If you want, you can provide a fallback function
to be executed when in the failure state.</p>
<p>For more about the circuit breaker pattern, there are lots of resources
on the web - search it! Fowler's blog post is one place to
<a href="http://martinfowler.com/bliki/CircuitBreaker.html">start reading</a>.</p>
<table>
<thead>
<tr>
<th></th>
<th>Project Info</th>
</tr>
</thead>
<tbody>
<tr>
<td>License:</td>
<td>Apache-2.0</td>
</tr>
<tr>
<td>Build:</td>
<td>make</td>
</tr>
<tr>
<td>Documentation:</td>
<td><a href="https://nodeshift.dev/opossum/">https://nodeshift.dev/opossum/</a></td>
</tr>
<tr>
<td>Typngs:</td>
<td><a href="https://github.com/DefinitelyTyped/DefinitelyTyped/tree/master/types/opossum">https://github.com/DefinitelyTyped/DefinitelyTyped/tree/master/types/opossum</a></td>
</tr>
<tr>
<td>Issue tracker:</td>
<td><a href="https://github.com/nodeshift/opossum/issues">https://github.com/nodeshift/opossum/issues</a></td>
</tr>
<tr>
<td>Engines:</td>
<td>Node.js 8.x, 10.x, 11.x, 12.x</td>
</tr>
</tbody>
</table>
<h2>Usage</h2>
<p>Let's say you've got an API that depends on something that might fail -
a network operation, or disk read, for example. Wrap those functions up in a
<code>CircuitBreaker</code> and you have control over your destiny.</p>
<pre class='hljs'><span class="hljs-keyword">const</span> CircuitBreaker = <span class="hljs-built_in">require</span>(<span class="hljs-string">'opossum'</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">asyncFunctionThatCouldFail</span> (<span class="hljs-params">x, y</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-comment">// Do something, maybe on the network or a disk</span>
  });
}

<span class="hljs-keyword">const</span> options = {
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">3000</span>, <span class="hljs-comment">// If our function takes longer than 3 seconds, trigger a failure</span>
  errorThresholdPercentage: <span class="hljs-number">50</span>, <span class="hljs-comment">// When 50% of requests fail, trip the circuit</span>
  resetTimeout: <span class="hljs-number">30000</span> <span class="hljs-comment">// After 30 seconds, try again.</span>
};
<span class="hljs-keyword">const</span> breaker = <span class="hljs-keyword">new</span> CircuitBreaker(asyncFunctionThatCouldFail, options);

breaker.fire(params)
  .then(<span class="hljs-built_in">console</span>.log)
  .catch(<span class="hljs-built_in">console</span>.error);</pre>
<h3>Fallback</h3>
<p>You can also provide a fallback function that will be executed in the
event of failure. To take some action when the fallback is performed,
listen for the <code>fallback</code> event.</p>
<pre class='hljs'><span class="hljs-keyword">const</span> breaker = <span class="hljs-keyword">new</span> CircuitBreaker(asyncFunctionThatCouldFail, options);
<span class="hljs-comment">// if asyncFunctionThatCouldFail starts to fail, firing the breaker</span>
<span class="hljs-comment">// will trigger our fallback function</span>
breaker.fallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-string">'Sorry, out of service right now'</span>);
breaker.on(<span class="hljs-string">'fallback'</span>, (result) =&gt; reportFallbackEvent(result));</pre>
<p>Once the circuit has opened, a timeout is set based on <code>options.resetTimeout</code>.
When the <code>resetTimeout</code> expires, <code>opossum</code> will enter the <code>halfOpen</code> state.
Once in the <code>halfOpen</code> state, the next time the circuit is fired, the circuit's
action will be executed again. If successful, the circuit will close and emit
the <code>close</code> event. If the action fails or times out, it immediately re-enters
the <code>open</code> state.</p>
<p>When a fallback function is triggered, it's considered a failure, and the
fallback function will continue to be executed until the breaker is closed.</p>
<h3>Browser</h3>
<p>Opossum really shines in a browser. You can use it to guard against network
failures in your AJAX calls.</p>
<p>We recommend using <a href="https://webpack.js.org/">webpack</a> to bundle your applications,
since it does not have the effect of polluting the <code>window</code> object with a global.
However, if you need it, you can access a <code>circuitBreaker</code> function in the global
namespace by doing something similar to what is shown in the below example.</p>
<p>Here is an example using <a href="https://hapijs.com">hapi.js</a>. See the
<a href="https://github.com/nodeshift-starters/opossum-examples/">opossum-examples</a>
repository for more detail.</p>
<p>Include <code>opossum.js</code> in your HTML file.</p>
<pre class='hljs'><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>My Super App<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">'text/javascript'</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/jquery.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">'text/javascript'</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/opossum.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">'text/javascript'</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/app.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
...
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></pre>
<p>In your application, set a route to the file, pointing to
<code>node_modules/opossum/dist/opossum-min.js</code>.</p>
<pre class='hljs'><span class="hljs-comment">// server.js</span>
<span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> Hapi.Server();
server.register(<span class="hljs-built_in">require</span>(<span class="hljs-string">'inert'</span>, (err) =&gt; possibleError(err)));
server.route({
  <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,
  <span class="hljs-attr">path</span>: <span class="hljs-string">'/opossum.js'</span>,
  <span class="hljs-attr">handler</span>: {
    <span class="hljs-attr">file</span>: {
      <span class="hljs-attr">path</span>: path.join(__dirname, <span class="hljs-string">'node_modules'</span>, <span class="hljs-string">'opossum'</span>, <span class="hljs-string">'dist'</span>, <span class="hljs-string">'opossum-min.js'</span>),
    }
  }
});</pre>
<p>In the browser's global scope will be a <code>circuitBreaker</code> function. Use it
to create circuit breakers, guarding against network failures in your REST
API calls.</p>
<pre class='hljs'><span class="hljs-comment">// app.js</span>
<span class="hljs-keyword">const</span> route = <span class="hljs-string">'https://example-service.com/rest/route'</span>;
<span class="hljs-keyword">const</span> circuitBreakerOptions = {
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">500</span>,
  <span class="hljs-attr">maxFailures</span>: <span class="hljs-number">3</span>,
  <span class="hljs-attr">resetTimeout</span>: <span class="hljs-number">5000</span>
};

<span class="hljs-keyword">const</span> circuit = circuitBreaker(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> $.<span class="hljs-keyword">get</span>(route), circuitBreakerOptions);
circuit.fallback(() =&gt; `${route} unavailable right now. Try later.<span class="hljs-string">`));
circuit.on('success', (result) =&gt; $(element).append(JSON.stringify(result)}));

$(() =&gt; {
  $('#serviceButton').click(() =&gt; circuit.fire().catch((e) =&gt; console.error(e)));
});</span></pre>
<h3>Events</h3>
<p>A <code>CircuitBreaker</code> will emit events for important things that occur.
Here are the events you can listen for.</p>
<ul>
<li><code>fire</code> - emitted when the breaker is fired.</li>
<li><code>reject</code> - emitted when the breaker is open (or halfOpen).</li>
<li><code>timeout</code> - emitted when the breaker action times out.</li>
<li><code>success</code> - emitted when the breaker action completes successfully</li>
<li><code>failure</code> - emitted when the breaker action fails, called with the error</li>
<li><code>open</code> - emitted when the breaker state changes to <code>open</code></li>
<li><code>close</code> - emitted when the breaker state changes to <code>closed</code></li>
<li><code>halfOpen</code> - emitted when the breaker state changes to <code>halfOpen</code></li>
<li><code>fallback</code> - emitted when the breaker has a fallback function and executes it</li>
<li><code>semaphoreLocked</code> - emitted when the breaker is at capacity and cannot execute the request</li>
<li><code>healthCheckFailed</code> - emitted when a user-supplied health check function returns a rejected promise</li>
</ul>
<p>Handling events gives a greater level of control over your application behavior.</p>
<pre class='hljs'><span class="hljs-keyword">const</span> circuit = circuitBreaker(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> $.<span class="hljs-keyword">get</span>(route), circuitBreakerOptions);

circuit.fallback(() =&gt; ({ body: <span class="hljs-string">`<span class="hljs-subst">${route}</span> unavailable right now. Try later.`</span> }));

circuit.on(<span class="hljs-string">'success'</span>,
  (result) =&gt; $(element).append(
    makeNode(<span class="hljs-string">`SUCCESS: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(result)}</span>`</span>)));

circuit.on(<span class="hljs-string">'timeout'</span>,
  () =&gt; $(element).append(
    makeNode(<span class="hljs-string">`TIMEOUT: <span class="hljs-subst">${route}</span> is taking too long to respond.`</span>)));

circuit.on(<span class="hljs-string">'reject'</span>,
  () =&gt; $(element).append(
    makeNode(<span class="hljs-string">`REJECTED: The breaker for <span class="hljs-subst">${route}</span> is open. Failing fast.`</span>)));

circuit.on(<span class="hljs-string">'open'</span>,
  () =&gt; $(element).append(
    makeNode(<span class="hljs-string">`OPEN: The breaker for <span class="hljs-subst">${route}</span> just opened.`</span>)));

circuit.on(<span class="hljs-string">'halfOpen'</span>,
  () =&gt; $(element).append(
    makeNode(<span class="hljs-string">`HALF_OPEN: The breaker for <span class="hljs-subst">${route}</span> is half open.`</span>)));

circuit.on(<span class="hljs-string">'close'</span>,
  () =&gt; $(element).append(
    makeNode(<span class="hljs-string">`CLOSE: The breaker for <span class="hljs-subst">${route}</span> has closed. Service OK.`</span>)));

circuit.on(<span class="hljs-string">'fallback'</span>,
  (data) =&gt; $(element).append(
    makeNode(<span class="hljs-string">`FALLBACK: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(data)}</span>`</span>)));</pre>
<h3>Promises vs. Callbacks</h3>
<p>The <code>opossum</code> API returns a <code>Promise</code> from <code>CircuitBreaker.fire()</code>.
But your circuit action - the async function that might fail -
doesn't have to return a promise. You can easily turn Node.js style
callback functions into something <code>opossum</code> understands by using the built in
Node core utility function <code>util.promisify()</code> .</p>
<pre class='hljs'><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">const</span> { promisify } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'util'</span>);
<span class="hljs-keyword">const</span> circuitBreaker = <span class="hljs-built_in">require</span>(<span class="hljs-string">'opossum'</span>);

<span class="hljs-keyword">const</span> readFile = promisify(fs.readFile);
<span class="hljs-keyword">const</span> breaker = circuitBreaker(readFile, options);

breaker.fire(<span class="hljs-string">'./package.json'</span>, <span class="hljs-string">'utf-8'</span>)
  .then(<span class="hljs-built_in">console</span>.log)
  .catch(<span class="hljs-built_in">console</span>.error);</pre>
<p>And just for fun, your circuit doesn't even really have to be a function.
Not sure when you'd use this - but you could if you wanted to.</p>
<pre class='hljs'><span class="hljs-keyword">const</span> breaker = circuitBreaker(<span class="hljs-string">'foo'</span>, options);

breaker.fire()
  .then(<span class="hljs-built_in">console</span>.log) <span class="hljs-comment">// logs 'foo'</span>
  .catch(<span class="hljs-built_in">console</span>.error);</pre>
<h3>Typings</h3>
<p>Typings are available <a href="https://github.com/DefinitelyTyped/DefinitelyTyped/tree/master/types/opossum">here</a>.</p>
<p>If you'd like to add them, run <code>npm install @types/opossum</code> in your project.</p>
<h3>Metrics</h3>
<h4>Prometheus</h4>
<p>The <a href="https://github.com/nodeshift/opossum-prometheus"><code>opossum-prometheus</code></a> module
can be used to produce metrics that are consumable by Prometheus.
These metrics include information about the circuit itself, for example how many
times it has opened, as well as general Node.js statistics, for example event loop lag.</p>
<h4>Hystrix</h4>
<p>The <a href="https://github.com/nodeshift/opossum-hystrix"><code>opossum-hystrix</code></a> module can
be used to produce metrics that are consumable by the Hystrix Dashboard.</p>
<h2>Troubleshooting</h2>
<p>You may run into issues related to too many listeners on an <code>EventEmitter</code> like this.</p>
<pre class='hljs'>(node:25619) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 10 unpipe listeners added. Use emitter.setMaxListeners() to increase <span class="hljs-built_in">limit</span>
(node:25619) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 drain listeners added. Use emitter.setMaxListeners() to increase <span class="hljs-built_in">limit</span>
(node:25619) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 error listeners added. Use emitter.setMaxListeners() to increase <span class="hljs-built_in">limit</span>
(node:25619) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 close listeners added. Use emitter.setMaxListeners() to increase <span class="hljs-built_in">limit</span>
(node:25619) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 finish listeners added. Use emitter.setMaxListeners() to increase <span class="hljs-built_in">limit</span></pre>
<p>In some cases, seeing this error might indicate a bug in client code, where many <code>CircuitBreaker</code>s are inadvertently being created. But there are legitimate scenarios where this may not be the case. For example, it could just be that you need more than 10 <code>CircuitBreaker</code>s in your app. That's ok.</p>
<p>To get around the error, you can set the number of listeners on the stream.</p>
<pre class='hljs'>circuit.stats.getHystrixStream().setMaxListeners(100);</pre>
<p>Or it could be that you have a large test suite which exercises some code that creates <code>CircuitBreaker</code>s and does so repeatedly. If the <code>CircuitBreaker</code> being created is only needed for the duration of the test, use <code>circuit.shutdown()</code> when the circuit is no longer in use to clean up all listeners.</p>

  
</section></div>
          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='circuitbreaker'>
      CircuitBreaker
    </h3>
    
    
  </div>
  

  <p>Constructs a <a href="#circuitbreaker">CircuitBreaker</a>.</p>

    <div class='pre p1 fill-light mt0'>new CircuitBreaker(action: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function">Function</a>, options: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</div>
  
  
    <p>
      Extends
      
        EventEmitter
      
    </p>
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>action</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function">Function</a>)</code>
	    The action to fire for this 
<a href="#circuitbreaker">CircuitBreaker</a>

          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>options</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</code>
	    Options for the 
<a href="#circuitbreaker">CircuitBreaker</a>

          </div>
          
          <table class='mt1 mb2 fixed-table h5 col-12'>
            <colgroup>
              <col width='30%' />
              <col width='70%' />
            </colgroup>
            <thead>
              <tr class='bold fill-light'>
                <th>Name</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody class='mt1'>
              
                <tr>
  <td class='break-word'><span class='code bold'>options.timeout</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number">Number</a></code>
  </td>
  <td class='break-word'><span>The time in milliseconds that action should
be allowed to execute before timing out. Default 10000 (10 seconds)
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>options.maxFailures</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number">Number</a></code>
  </td>
  <td class='break-word'><span>(Deprecated) The number of times the
circuit can fail before opening. Default 10.
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>options.resetTimeout</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number">Number</a></code>
  </td>
  <td class='break-word'><span>The time in milliseconds to wait before
setting the breaker to 
<code>halfOpen</code>
 state, and trying the action again.
Default: 30000 (30 seconds)
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>options.rollingCountTimeout</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number">Number</a></code>
  </td>
  <td class='break-word'><span>Sets the duration of the
statistical rolling window, in milliseconds. This is how long Opossum keeps
metrics for the circuit breaker to use and for publishing. Default: 10000
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>options.rollingCountBuckets</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number">Number</a></code>
  </td>
  <td class='break-word'><span>Sets the number of buckets the
rolling statistical window is divided into. So, if
options.rollingCountTimeout is 10000, and options.rollingCountBuckets is 10,
then the statistical window will be 1000 1 second snapshots in the
statistical window. Default: 10
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>options.name</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">String</a></code>
  </td>
  <td class='break-word'><span>the circuit name to use when reporting stats.
Default: the name of the function this circuit controls.
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>options.rollingPercentilesEnabled</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code>
  </td>
  <td class='break-word'><span>This property indicates
whether execution latencies should be tracked and calculated as percentiles.
If they are disabled, all summary statistics (mean, percentiles) are
returned as -1. Default: false
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>options.capacity</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number">Number</a></code>
  </td>
  <td class='break-word'><span>the number of concurrent requests allowed.
If the number currently executing function calls is equal to
options.capacity, further calls to 
<code>fire()</code>
 are rejected until at least one
of the current requests completes. Default: 
<code>Number.MAX_SAFE_INTEGER</code>
.
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>options.errorThresholdPercentage</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number">Number</a></code>
  </td>
  <td class='break-word'><span>the error percentage at
which to open the circuit and start short-circuiting requests to fallback.
Default: 50
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>options.enabled</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code>
  </td>
  <td class='break-word'><span>whether this circuit is enabled upon
construction. Default: true
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>options.allowWarmUp</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></code>
  </td>
  <td class='break-word'><span>determines whether to allow failures
without opening the circuit during a brief warmup period (this is the

<code>rollingCountDuration</code>
 property). Default: false
allow before enabling the circuit. This can help in situations where no
matter what your 
<code>errorThresholdPercentage</code>
 is, if the first execution
times out or fails, the circuit immediately opens. Default: 0
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>options.volumeThreshold</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number">Number</a></code>
  </td>
  <td class='break-word'><span>the minimum number of requests within
the rolling statistical window that must exist before the circuit breaker
can open. This is similar to 
<code>options.allowWarmUp</code>
 in that no matter how many
failures there are, if the number of requests within the statistical window
does not exceed this threshold, the circuit will remain closed. Default: 0
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>options.errorFilter</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function">Function</a></code>
  </td>
  <td class='break-word'><span>an optional function that will be
called when the circuit's function fails (returns a rejected Promise). If
this function returns truthy, the circuit's failPure statistics will not be
incremented. This is useful, for example, when you don't want HTTP 404 to
trip the circuit, but still want to handle it as a failure case.
</span></td>
</tr>


              
            </tbody>
          </table>
          
        </div>
      
    </div>
  

  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Static Members</div>
    <div class="clearfix">
  
    <div class='border-bottom' id='circuitbreakercircuits'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>circuits()</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Gets a Set iterator of all active circuits. If a circuit
has been created, but subsequently shut down, it will not
be included in the Set iterator.</p>

    <div class='pre p1 fill-light mt0'>circuits(): Iterator</div>
  
  

  
  
  
  
  
  

  

  

  
    
      <div class='py1 quiet mt1 prose-big'>Returns</div>
      <code>Iterator</code>:
        an Iterator object containing a reference
to all {CircuitBreaker} instances that have been created.

      
    
  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
</div>

  

  
    <div class='py1 quiet mt1 prose-big'>Instance Members</div>
    <div class="clearfix">
  
    <div class='border-bottom' id='circuitbreakerclose'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>close()</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Closes the breaker, allowing the action to execute again</p>

    <div class='pre p1 fill-light mt0'>close(): void</div>
  
  

  
  
  
  
  
  

  

  

  
    
      <div class='py1 quiet mt1 prose-big'>Returns</div>
      <code>void</code>:
        

      
    
  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakeropen'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>open()</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Opens the breaker. Each time the breaker is fired while the circuit is
opened, a failed Promise is returned, or if any fallback function
has been provided, it is invoked.</p>

    <div class='pre p1 fill-light mt0'>open(): void</div>
  
  

  
  
  
  
  
  

  

  

  
    
      <div class='py1 quiet mt1 prose-big'>Returns</div>
      <code>void</code>:
        

      
    
  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakershutdown'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>shutdown()</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Shuts down this circuit breaker. All subsequent calls to the
circuit will fail, returning a rejected promise.</p>

    <div class='pre p1 fill-light mt0'>shutdown(): void</div>
  
  

  
  
  
  
  
  

  

  

  
    
      <div class='py1 quiet mt1 prose-big'>Returns</div>
      <code>void</code>:
        

      
    
  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakerisshutdown'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>isShutdown</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Determines if the circuit has been shutdown.</p>

    <div class='pre p1 fill-light mt0'>isShutdown</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean">Boolean</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakername'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>name</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Gets the name of this circuit</p>

    <div class='pre p1 fill-light mt0'>name</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">String</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakergroup'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>group</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Gets the name of this circuit group</p>

    <div class='pre p1 fill-light mt0'>group</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">String</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakerpendingclose'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>pendingClose</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Gets whether this cicruit is in the <code>pendingClosed</code> state</p>

    <div class='pre p1 fill-light mt0'>pendingClose</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean">Boolean</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakerclosed'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>closed</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>True if the circuit is currently closed. False otherwise.</p>

    <div class='pre p1 fill-light mt0'>closed</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean">Boolean</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakeropened'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>opened</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>True if the circuit is currently opened. False otherwise.</p>

    <div class='pre p1 fill-light mt0'>opened</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean">Boolean</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakerhalfopen'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>halfOpen</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>True if the circuit is currently half opened. False otherwise.</p>

    <div class='pre p1 fill-light mt0'>halfOpen</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean">Boolean</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakerstatus'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>status</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>The current <a href="#status">Status</a> of this <a href="#circuitbreaker">CircuitBreaker</a></p>

    <div class='pre p1 fill-light mt0'>status</div>
  
    <p>
      Type:
      <a href="#status">Status</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakerstats'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>stats</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Get the current stats for the circuit.</p>

    <div class='pre p1 fill-light mt0'>stats</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakerenabled'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>enabled</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Gets whether the circuit is enabled or not</p>

    <div class='pre p1 fill-light mt0'>enabled</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean">Boolean</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakerwarmup'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>warmUp</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Gets whether the circuit is currently in warm up phase</p>

    <div class='pre p1 fill-light mt0'>warmUp</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean">Boolean</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakervolumethreshold'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>volumeThreshold</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Gets the volume threshold for this circuit</p>

    <div class='pre p1 fill-light mt0'>volumeThreshold</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean">Boolean</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakerfallback'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>fallback(func)</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Provide a fallback function for this <a href="#circuitbreaker">CircuitBreaker</a>. This
function will be executed when the circuit is <code>fire</code>d and fails.
It will always be preceded by a <code>failure</code> event, and <code>breaker.fire</code> returns
a rejected Promise.</p>

    <div class='pre p1 fill-light mt0'>fallback(func: (<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function">Function</a> | <a href="#circuitbreaker">CircuitBreaker</a>)): <a href="#circuitbreaker">CircuitBreaker</a></div>
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>func</span> <code class='quiet'>((<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function">Function</a> | <a href="#circuitbreaker">CircuitBreaker</a>))</code>
	    the fallback function to execute
when the breaker has opened or when a timeout or error occurs.

          </div>
          
        </div>
      
    </div>
  

  

  
    
      <div class='py1 quiet mt1 prose-big'>Returns</div>
      <code><a href="#circuitbreaker">CircuitBreaker</a></code>:
        this

      
    
  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakerfire'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>fire()</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Execute the action for this circuit. If the action fails or times out, the
returned promise will be rejected. If the action succeeds, the promise will
resolve with the resolved value from action. If a fallback function was
provided, it will be invoked in the event of any failure or timeout.</p>

    <div class='pre p1 fill-light mt0'>fire(): <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a>&#x3C;any></div>
  
  

  
  
  
  
  
  

  

  

  
    
      <div class='py1 quiet mt1 prose-big'>Returns</div>
      <code><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a>&#x3C;any></code>:
        promise resolves with the circuit function's return
value on success or is rejected on failure of the action.

      
    
  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakerclearcache'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>clearCache()</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Clears the cache of this <a href="#circuitbreaker">CircuitBreaker</a></p>

    <div class='pre p1 fill-light mt0'>clearCache(): void</div>
  
  

  
  
  
  
  
  

  

  

  
    
      <div class='py1 quiet mt1 prose-big'>Returns</div>
      <code>void</code>:
        

      
    
  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakerhealthcheck'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>healthCheck(func, interval?)</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Provide a health check function to be called periodically. The function
should return a Promise. If the promise is rejected the circuit will open.
This is in addition to the existing circuit behavior as defined by
<code>options.errorThresholdPercentage</code> in the constructor. For example, if the
health check function provided here always returns a resolved promise, the
circuit can still trip and open if there are failures exceeding the
configured threshold. The health check function is executed within the
circuit breaker's execution context, so <code>this</code> within the function is the
circuit breaker itself.</p>

    <div class='pre p1 fill-light mt0'>healthCheck(func: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function">Function</a>, interval: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number">Number</a>?): void</div>
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>func</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function">Function</a>)</code>
	    a health check function which returns a promise.

          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>interval</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number">Number</a>?)</code>
	    the amount of time between calls to the health
check function. Default: 5000 (5 seconds)

          </div>
          
        </div>
      
    </div>
  

  

  
    
      <div class='py1 quiet mt1 prose-big'>Returns</div>
      <code>void</code>:
        

      
    
  

  
    <div class='py1 quiet mt1 prose-big'>Throws</div>
    <ul>
      
        <li><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/TypeError">TypeError</a>: if 
<code>interval</code>
 is supplied but not a number
</li>
      
    </ul>
  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakerenable'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>enable()</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Enables this circuit. If the circuit is the  disabled
state, it will be re-enabled. If not, this is essentially
a noop.</p>

    <div class='pre p1 fill-light mt0'>enable(): void</div>
  
  

  
  
  
  
  
  

  

  

  
    
      <div class='py1 quiet mt1 prose-big'>Returns</div>
      <code>void</code>:
        

      
    
  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='circuitbreakerdisable'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>disable()</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Disables this circuit, causing all calls to the circuit's function
to be executed without circuit or fallback protection.</p>

    <div class='pre p1 fill-light mt0'>disable(): void</div>
  
  

  
  
  
  
  
  

  

  

  
    
      <div class='py1 quiet mt1 prose-big'>Returns</div>
      <code>void</code>:
        

      
    
  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
</div>

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='eventcircuitbreakerhalfopen'>
      CircuitBreaker#halfOpen
    </h3>
    
    
  </div>
  

  <p>Emitted after <code>options.resetTimeout</code> has elapsed, allowing for
a single attempt to call the service again. If that attempt is
successful, the circuit will be closed. Otherwise it remains open.</p>

    <div class='pre p1 fill-light mt0'>CircuitBreaker#halfOpen</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number">Number</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='eventcircuitbreakerclose'>
      CircuitBreaker#close
    </h3>
    
    
  </div>
  

  <p>Emitted when the breaker is reset allowing the action to execute again</p>

    <div class='pre p1 fill-light mt0'>CircuitBreaker#close</div>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='eventcircuitbreakeropen'>
      CircuitBreaker#open
    </h3>
    
    
  </div>
  

  <p>Emitted when the breaker opens because the action has
failed more than <code>options.maxFailures</code> number of times.</p>

    <div class='pre p1 fill-light mt0'>CircuitBreaker#open</div>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='eventcircuitbreakershutdown'>
      CircuitBreaker#shutdown
    </h3>
    
    
  </div>
  

  <p>Emitted when the circuit breaker has been shut down.</p>

    <div class='pre p1 fill-light mt0'>CircuitBreaker#shutdown</div>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='eventcircuitbreakerfire'>
      CircuitBreaker#fire
    </h3>
    
    
  </div>
  

  <p>Emitted when the circuit breaker action is executed</p>

    <div class='pre p1 fill-light mt0'>CircuitBreaker#fire</div>
  
    <p>
      Type:
      any
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='eventcircuitbreakercachehit'>
      CircuitBreaker#cacheHit
    </h3>
    
    
  </div>
  

  <p>Emitted when the circuit breaker is using the cache
and finds a value.</p>

    <div class='pre p1 fill-light mt0'>CircuitBreaker#cacheHit</div>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='eventcircuitbreakercachemiss'>
      CircuitBreaker#cacheMiss
    </h3>
    
    
  </div>
  

  <p>Emitted when the circuit breaker does not find a value in
the cache, but the cache option is enabled.</p>

    <div class='pre p1 fill-light mt0'>CircuitBreaker#cacheMiss</div>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='eventcircuitbreakerreject'>
      CircuitBreaker#reject
    </h3>
    
    
  </div>
  

  <p>Emitted when the circuit breaker is open and failing fast</p>

    <div class='pre p1 fill-light mt0'>CircuitBreaker#reject</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='eventcircuitbreakertimeout'>
      CircuitBreaker#timeout
    </h3>
    
    
  </div>
  

  <p>Emitted when the circuit breaker action takes longer than
<code>options.timeout</code></p>

    <div class='pre p1 fill-light mt0'>CircuitBreaker#timeout</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='eventcircuitbreakersuccess'>
      CircuitBreaker#success
    </h3>
    
    
  </div>
  

  <p>Emitted when the circuit breaker action succeeds</p>

    <div class='pre p1 fill-light mt0'>CircuitBreaker#success</div>
  
    <p>
      Type:
      any
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='eventcircuitbreakersemaphorelocked'>
      CircuitBreaker#semaphoreLocked
    </h3>
    
    
  </div>
  

  <p>Emitted when the rate limit has been reached and there
are no more locks to be obtained.</p>

    <div class='pre p1 fill-light mt0'>CircuitBreaker#semaphoreLocked</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='eventcircuitbreakerhealthcheckfailed'>
      CircuitBreaker#healthCheckFailed
    </h3>
    
    
  </div>
  

  <p>Emitted with the user-supplied health check function
returns a rejected promise.</p>

    <div class='pre p1 fill-light mt0'>CircuitBreaker#healthCheckFailed</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='eventcircuitbreakerfallback'>
      CircuitBreaker#fallback
    </h3>
    
    
  </div>
  

  <p>Emitted when the circuit breaker executes a fallback function</p>

    <div class='pre p1 fill-light mt0'>CircuitBreaker#fallback</div>
  
    <p>
      Type:
      any
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='eventcircuitbreakerfailure'>
      CircuitBreaker#failure
    </h3>
    
    
  </div>
  

  <p>Emitted when the circuit breaker action fails</p>

    <div class='pre p1 fill-light mt0'>CircuitBreaker#failure</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='status'>
      Status
    </h3>
    
    
  </div>
  

  <p>Tracks execution status for a given <a href="#circuitbreaker">CircuitBreaker</a>.
A Status instance is created for every <a href="#circuitbreaker">CircuitBreaker</a>
and does not typically need to be created by a user.</p>
<p>A Status instance will listen for all events on the <a href="#circuitbreaker">CircuitBreaker</a>
and track them in a rolling statistical window. The window duration is
determined by the <code>rollingCountTimeout</code> option provided to the
<a href="#circuitbreaker">CircuitBreaker</a>. The window consists of an array of Objects,
each representing the counts for a <a href="#circuitbreaker">CircuitBreaker</a>'s events.</p>
<p>The array's length is determined by the <a href="#circuitbreaker">CircuitBreaker</a>'s
<code>rollingCountBuckets</code> option. The duration of each slice of the window
is determined by dividing the <code>rollingCountTimeout</code> by
<code>rollingCountBuckets</code>.</p>

    <div class='pre p1 fill-light mt0'>new Status(options: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</div>
  
  
    <p>
      Extends
      
        EventEmitter
      
    </p>
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>options</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</code>
	    for the status window

          </div>
          
          <table class='mt1 mb2 fixed-table h5 col-12'>
            <colgroup>
              <col width='30%' />
              <col width='70%' />
            </colgroup>
            <thead>
              <tr class='bold fill-light'>
                <th>Name</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody class='mt1'>
              
                <tr>
  <td class='break-word'><span class='code bold'>options.rollingCountBuckets</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number">Number</a></code>
  </td>
  <td class='break-word'><span>number of buckets in the window
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>options.rollingCountTimeout</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number">Number</a></code>
  </td>
  <td class='break-word'><span>the duration of the window
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>options.rollingPercentilesEnabled</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean">Boolean</a></code>
  </td>
  <td class='break-word'><span>whether to calculate
percentiles
</span></td>
</tr>


              
            </tbody>
          </table>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'><span class="hljs-comment">// Creates a 1 second window consisting of ten time slices,</span>
<span class="hljs-comment">// each 100ms long.</span>
<span class="hljs-keyword">const</span> circuit = circuitBreaker(fs.readFile,
 { <span class="hljs-attr">rollingCountBuckets</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">rollingCountTimeout</span>: <span class="hljs-number">1000</span>});

<span class="hljs-comment">// get the cumulative statistics for the last second</span>
circuit.status.stats;

<span class="hljs-comment">// get the array of 10, 1 second time slices for the last second</span>
circuit.status.window;</pre>
    
  

  

  
    <div class='py1 quiet mt1 prose-big'>Instance Members</div>
    <div class="clearfix">
  
    <div class='border-bottom' id='statusstats'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>stats</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Get the cumulative stats for the current window</p>

    <div class='pre p1 fill-light mt0'>stats</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='statuswindow'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>â–¸</a>
            <span class='code strong strong truncate'>window</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Gets the stats window as an array of time-sliced objects.</p>

    <div class='pre p1 fill-light mt0'>window</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
</div>

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='eventstatussnapshot'>
      Status#snapshot
    </h3>
    
    
  </div>
  

  <p>Emitted at each time-slice. Listeners for this
event will receive a cumulative snapshot of the current status window.</p>

    <div class='pre p1 fill-light mt0'>Status#snapshot</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  
</section>

          
        
      </div>
    </div>
  <script src='assets/anchor.js'></script>
  <script src='assets/split.js'></script>
  <script src='assets/site.js'></script>
</body>
</html>
